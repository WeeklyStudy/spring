# #7 서블릿 컨테이너와 서블릿이란 무엇이고, 서블릿 생명주기는 어떻게 될까?

## 1. 서블릿

> 자바 서블릿은 웹페이지를 동적으로 생성하는 서버 측 프로그램 혹은 그 사양을 의미

- 자바를 사용하여 웹을 만들기 위한 기술
- 클라이언트가 요청을 하면 로직 수행 후 그 결과를 다시 전송해주는 역할을 함
- **서블릿은 웹 요청과 응답을 간단한 메소드 호출로 다룰 수 있게 해주는 기술**
    
    ⇒ 개발자는 `비즈니스 로직`에만 `집중`할 수 있도록 해줌
    
- 데이터베이스 연결, 로그인 검증, 데이터 처리 등을 수행 가능

## 2. 서블릿 컨테이너

> 웹 어플리케이션의 서블릿을 관리하고 실행하는 환경을 제공하는 소프트웨어

### 2-1) 특징

- 구현된 Servlet 클래스의 규칙에 맞게 서블릿을 관리
- 클라이언트의 요청을 받아 적절한 서블릿 호출하여 요청 처리
- 서블릿의 생명주기 이벤트를 관리하며 서블릿 초기화, 서비스 처리, 소멸 등을 관리
- 멀티 스레드 환경에서 여러 요청을 병렬로 처리하고 스레드 풀을 관리
- 클라이언트 요청을 받고 응답을 할 수 있도록 `웹 서버`와 `소켓을 통해 통신`(소켓통신)함

### 2-2) 서블릿 컨테이너의 역할

- 웹 서버와 통신 지원
    
    **서블릿 컨테이너는 `웹 서버와 소켓을 만들어` 클라이언트 요청을 받고 응답 할 수 있도록 지원함**
    
    listen, accept 과정을 API로 제공하여 복잡한 과정 생략 ⇒ 비즈니스 로직 집중 가능
    
- 생명주기 관리
    
    서블릿 컨테이너는 서블릿의 생성과 소멸을 관리함
    
    서블릿 클래스를 인스턴스화, 초기화하고 요청이 들어오면 적절한 서블릿을 호출
    
- 멀티 스레드 지원 및 관리
    
    서블릿 컨테이너는 클라이언트 요청이 들어올 때마다 자바 스레드를 생성한다. 원래는 직접 스레드를 생성, 관리해주어야 하지만 서버가 멀티 스레드를 생성, 관리 해주기 안정성있게 동시 요청 처리가 가능하다.
    
- 선언적인 보안관리
    
    보안 관련 기능을 제공하기 때문에 보안 메서드를 구현하지 않아도 된다.
    

## 3. 서블릿 생명주기

클라이언트 요청에 따라 단계로 진행됨

1. 서블릿 인스턴스 생성
    
    서블릿클래스를 로드하고 초기화함 ⇒ init() 통해 초기화 작업 수행
    
2. 클라이언트 요청 처리
    
    클라이언트가 요청을 보내면 서블릿 컨테이너는 스레드 생성하고 스레드에서 서블릿의 service() 메서드 호출
    
3. 응답 전송
    
    service() 메서드 요청 완료 시 생성된 응답을 클라이언트로 전송
    
4. 서블릿 소멸
    
    서블릿 사용이 더 이상 필요하지 않을 때 destroy() 메서드 호출하여 서블릿 소멸시킴
    
    자원의 해제, 정리작업, 데이터 저장 등 수행 가능
    

## 참고자료

- [**[[Web] 서블릿(Servlet)이란? 서블릿 컨테이너란?]**](https://code-lab1.tistory.com/210)
- [**서블릿(Servlet)과 서블릿 컨테이너(Servlet Container)**](https://velog.io/@yoho98/%EC%84%9C%EB%B8%94%EB%A6%BFServlet%EA%B3%BC-%EC%84%9C%EB%B8%94%EB%A6%BF-%EC%BB%A8%ED%85%8C%EC%9D%B4%EB%84%88Servlet-Container-y88kny7g)

</br>

# #8 WAS(Web Application Server)의 스레드 풀(Thread Pool)은 무엇이고, 스레드 풀을 사용하는 이유는 무엇인가?

## 1. WAS와 스레드의 관계

- 클라이언트 요청의 애플리케이션 코드를 실행하기 위해 스레드가 필요
- WAS는 여러 클라이언트의 동시 요청을 병렬 처리하기 위해서 여러 스레드를 생성하고 컴퓨팅 자원(CPU, 메모리 등)을 사용함

## 2. 스레드 풀이란?

### 2-1) 역할

- WAS 내부에서 스레드를 관리하고 재사용하는 매커니즘으로 동시 요청 처리를 효과적으로 관리하고 조절함
- 스레드 풀은 미리 정의된 개수의 스레드를 생성하고 유지하며, 요청이 들어올 때 스레드를 할당

### 2-2) 동작원리

1. 스레드 풀은 미리 정의된 개수의 스레드를 생성하고 준비상태로 유지
2. 클라이언트 요청이 들어오면 스레드 풀에서 사용가능한 스레드를 할당하여 요청을 처리
3. 요청 처리가 완료되면 사용된 스레드는 삭제되지 않고 스레드 풀로 반환되어 재사용
4. 모든 스레드가 사용 중이라면, 새로운 요청은 `대기` 상태가 되거나 `거부`됨

## 3. 사용하는 이유(장점)

- 자원의 효율성 :
    
    스레드를 생성 및 소멸에 의한 오버 헤드 발생으로 시스템 리소스가 낭비될 수 있는데 스레드 풀을 통해 스레드를 미리 생성하고 관리함으로써 시스템 자원을 효과적으로 사용할 수 있음
    
- 동시성 관리 :
    
    스레드 풀은 스레드 개수 제한, 스레드 할당, 대기, 스레드 재사용 등을 통해 동시 요청을 효과적으로 처리할 수 있게함으로써 과도한 요청으로 인한 서버 부하를 분산하고 안정성을 유지함
    

## 정리

- 스레드 풀은 WAS(Web Application Server)에서 다수의 클라이언트 요청을 처리하기 위한 핵심적인 매커니즘이다.
- 스레드 풀은 스레드를 미리 정의된 개수만큼 생성하고 클라이언트 요청 시 할당하며, 로직 처리가 완료된 스레드를 반환받는다.
- 스레드 풀에 스레드를 미리 생성, 관리함으로써 오버헤드를 줄여 시스템 리소스를 효과적으로 사용할 수 있다.
- 스레드 풀을 통해 동시 요청을 효과적으로 처리함으로써 서버 부하를 분산하고 안정성을 유지할 수 있다.

</br>

# #9 서블릿은 어떻게 동작하는가?

## 서블릿 동작 방식

1. 사용자(클라이언트)가 URL을 통해 요청을 보내면 HTTP Request를 Servlet Conatiner로 전송합니다.
2. HTTP Request를 전송받은 Servlet Container는 HttpServletRequest, HttpServletResponse 두 객체를 생성합니다.
3. 다음으로 요청한 URL을 분석하여 어느 서블릿에 대해 요청을 한 것인지 찾습니다.
4. 해당 서블릿에서 service메소드를 호출한 후 POST, GET여부에 따라 `doGet()` 또는 `doPost()`를 호출합니다.
5. `doGet()`나 `doPost()` 메소드는 동적 페이지를 생성한 후 `HttpServletResponse`객체에 응답을 보냅니다.
6. 응답이 끝나면 `HttpServletRequest`, `HttpServletResponse` 두 객체를 소멸시킵니다.

## 참고자료

- [**[서블릿(Servlet)의 동작구조]**](https://webfirewood.tistory.com/38)
